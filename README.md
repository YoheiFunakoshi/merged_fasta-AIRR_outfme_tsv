# merged_fasta ? AIRR outfmt 19 (IgBLAST GUI)

?????FASTA?extendedFrags.fasta??????IgBLAST?AIRR outfmt 19?TSV????????GUI???

## ?????
- ?????FASTA?????IgBLAST???
- AIRR outfmt 19 TSV???

## ??????
- ??????????: `AIRR_igblast_app.lnk`
- ???????: `AIRR_igblast_app.pyw`
- ???: `result_AIRR_outfmat/`

## ????????????
- IgBLAST: `C:/Program Files/NCBI/igblast-1.21.0/bin/igblastn.exe`

## ?????????????????
`C:/Users/Yohei Funakoshi/Desktop/IgBlast??????`

??????? **???????????????** ??????????????
?????/?????????? `AIRR_igblast_app.pyw` ? `REF_DIR_FULL` ??????????
?ASCII????????????????????? `refdata` ???ASCII??????????????????

### ?????????
- `db/` : IMGT???FASTA?????BLAST???????????????
- `IMGT_raw/` : IMGT????????FASTA?V/D/J ???????
- `internal_data/` : IgBLAST???????????IMGT???FWR/CDR??????
- `optional_file/` : J????????/ CDR3??????????-auxiliary_data ????

## ???????????????

### 1) IgBLAST???????
- ??: https://ncbi.github.io/igblast/
- ???????: `C:/Program Files/NCBI/igblast-1.21.0/`

### 2) ????????????
```
C:/Users/Yohei Funakoshi/Desktop/IgBlast??????
```

### 3) internal_data / optional_file ????
IgBLAST????????????????
```
C:/Program Files/NCBI/igblast-1.21.0/internal_data
C:/Program Files/NCBI/igblast-1.21.0/optional_file
```

### 4) IMGT????IgH?V/D/J FASTA???
IMGT?????? Human ? IGHV / IGHD / IGHJ ??????????????????
```
C:/Users/Yohei Funakoshi/Desktop/IgBlast??????/IMGT_raw
```
??????:
- `IMGT_IGHV.fasta`
- `IMGT_IGHD.fasta`
- `IMGT_IGHJ.fasta`

### 5) IMGT????????imgt.fasta???
IMGT?????IgBLAST?????????????

**Python??Perl??????**
```python
from pathlib import Path

ref = Path(r"C:/Users/Yohei Funakoshi/Desktop/IgBlast??????")
inputs = [ref/"IMGT_raw"/"IMGT_IGHV.fasta", ref/"IMGT_raw"/"IMGT_IGHD.fasta", ref/"IMGT_raw"/"IMGT_IGHJ.fasta"]

for inp in inputs:
    outp = inp.with_suffix('.imgt.fasta')
    with inp.open('r', encoding='utf-8', errors='ignore') as fin, outp.open('w', encoding='ascii', errors='ignore') as fout:
        for line in fin:
            if line.startswith('>'):
                parts = line[1:].strip().split('|')
                gene = parts[1].strip() if len(parts) >= 2 and parts[1].strip() else line[1:].strip()
                fout.write('>' + gene + '
')
            else:
                seq = line.strip().upper()
                if seq:
                    fout.write(seq + '
')
```

???:
- `IMGT_IGHV.imgt.fasta`
- `IMGT_IGHD.imgt.fasta`
- `IMGT_IGHJ.imgt.fasta`

### 6) makeblastdb?DB??
```
"C:/Program Files/NCBI/igblast-1.21.0/bin/makeblastdb.exe" -parse_seqids -dbtype nucl -in IMGT_IGHV.imgt.fasta -out db/IMGT_IGHV.imgt
"C:/Program Files/NCBI/igblast-1.21.0/bin/makeblastdb.exe" -parse_seqids -dbtype nucl -in IMGT_IGHD.imgt.fasta -out db/IMGT_IGHD.imgt
"C:/Program Files/NCBI/igblast-1.21.0/bin/makeblastdb.exe" -parse_seqids -dbtype nucl -in IMGT_IGHJ.imgt.fasta -out db/IMGT_IGHJ.imgt
```

## ???????
1. `AIRR_igblast_app.lnk` ????????
2. ?????FASTA?extendedFrags.fasta????
3. Run???
4. `result_AIRR_outfmat` ? `*.igblast.airr.tsv` ??????

## ??
- ??DB????????????IgH?????DB????
- ??DB??????????IMGT?FASTA?????makeblastdb???????????
